/// <reference path="./RGLM.ts">
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.rglm = exports.rgl = exports.eolconv = void 0;
const tslib_1 = require("tslib");
const assert = tslib_1.__importStar(require("assert"));
const event = tslib_1.__importStar(require("events"));
const readline = tslib_1.__importStar(require("readline"));
const fs = tslib_1.__importStar(require("fs-extra"));
const os = tslib_1.__importStar(require("os"));
const path = tslib_1.__importStar(require("path"));
const rglm = tslib_1.__importStar(require("./RGLM"));
exports.rglm = rglm;
const util = tslib_1.__importStar(require("util"));
exports.eolconv = /((?<!\r)\n(?!\r)|(?<!\n)\r(?!\n)|\r\n|\n\r)/gmis;
var rgl;
(function (rgl) {
    const dbg = util.debuglog("RGL");
    dbg(`ins ${__dirname}`);
    rgl.scrollUp = (by = 1) => `\x1b[${by}S`, rgl.scrollDown = (by = 1) => `\x1b[${by}T`, rgl.save = `\x1b7\x1b[s`, rgl.restore = `\x1b8\x1b[u`, rgl.mouseOn = `\x1b[1z\x1b[?1000;1003;1005h`, rgl.mouseOff = `\x1b[0z\x1b[?1000;1003;1005;1006;1015l`;
    /**
     * Main packaging Class
     */
    class RGL extends event.EventEmitter {
        cfg;
        /**
         * TTY streams bound to app
         */
        _bound = {
            sin: process.stdin,
            sout: process.stdout,
            serr: process.stderr,
            sinbind: null,
        };
        /**
         * SOUT cursor state
         */
        cursor = [0, 0];
        /**
         * Source of package Config in case of fs load
         */
        #_loadedFrom = "";
        static defaults = {
            description: "",
            main: "./main.js",
            version: "0.1",
            mappings: "./mappings.js",
            name: process.title,
            keywords: [],
            "$schema": path.join(__dirname, "../../rglcfg.schema.json")
        };
        /**
         * Special keys for convenience
         */
        static special_keys = {
            ctrlC: Buffer.from("03", "hex"),
            ctrlV: Buffer.from("16", "hex"),
            ctrlZ: Buffer.from("1a", "hex"),
            ctrlY: Buffer.from("19", "hex"),
            up: Buffer.from("1b5b41", "hex"),
            down: Buffer.from("1b5b42", "hex"),
            right: Buffer.from("1b5b43", "hex"),
            left: Buffer.from("1b5b44", "hex"),
            shiftUp: Buffer.from("1b5b313b3241", "hex"),
            shiftDown: Buffer.from("1b5b313b3242", "hex"),
            shiftRight: Buffer.from("1b5b313b3243", "hex"),
            shiftLeft: Buffer.from("1b5b313b3244", "hex"),
            ctrlUp: Buffer.from("1b5b313b3541", "hex"),
            ctrlDown: Buffer.from("1b5b313b3542", "hex"),
            ctrlRight: Buffer.from("1b5b313b3543", "hex"),
            ctrlLeft: Buffer.from("1b5b313b3544", "hex"),
            fnUp: Buffer.from("1b5b357e", "hex"),
            fnDown: Buffer.from("1b5b367e", "hex"),
            fnRight: Buffer.from("1b5b347e", "hex"),
            fnLeft: Buffer.from("1b5b317e", "hex"),
            ctrlShiftUp: Buffer.from("1b5b313b3641", "hex"),
            ctrlShiftDown: Buffer.from("1b5b313b3642", "hex"),
            ctrlShiftRight: Buffer.from("1b5b313b3643", "hex"),
            ctrlShiftLeft: Buffer.from("1b5b313b3644", "hex"),
            ctrlFnUp: Buffer.from("1b5b353b357e", "hex"),
            ctrlFnDown: Buffer.from("1b5b363b357e", "hex"),
            ctrlFnRight: Buffer.from("1b5b343b357e", "hex"),
            ctrlFnLeft: Buffer.from("1b5b313b357e", "hex"),
            enter: Buffer.from("0d", "hex"),
            altEnter: Buffer.from("1b0d", "hex"),
            back: Buffer.from("08", "hex"),
            del: Buffer.from("1b5b337e", "hex"),
            tab: Buffer.from("09", "hex"),
        };
        constructor(cfg) {
            super();
            this.cfg = cfg;
            this.cfg = Object.assign(Object.assign(Object.create(null), RGL.defaults), cfg);
            assert.ok(this.cfg.name, "RGL 'name' must be provided in the config");
            this.cfg.main = "./" + path.normalize(this.cfg.main || RGL.defaults.main);
            this.cfg.mappings = "./" + path.normalize(this.cfg.mappings || RGL.defaults.mappings || "./mappings.js");
            //process.stdout.write(`\x1b]0;${this.cfg.name}\a`);
            process.title = this.cfg.name || process.title || "RGL";
            this.parseMappings();
        } //ctor
        get dimens() {
            return this.sout?.getWindowSize() || [0, 0];
        } //g-dimens
        get cDpt() {
            return this.colorDepth();
        } //g-cDpt
        get serr() {
            return this._bound.serr || this._bound.sout || process.stderr;
        } //g-serr
        get sout() {
            return this._bound.sout || process.stdout;
        } //g-sout
        get sin() {
            return this._bound.sin || process.stdin;
        } //g-sin
        /**
         * Parse Mappings from File
         */
        parseMappings(from = this.cfg.mappings) {
            assert.ok(from, "'mappings' must be a valid path");
            from = path.join(process.cwd(), from);
            delete require.cache[from];
            try {
                return rglm.RGLM.RGLMChunk.mappings = require(from);
            }
            catch (e) {
                return rglm.RGLM.RGLMChunk.mappings = require(this.cfg.mappings = path.join(__dirname, "../../mappings.js"));
            }
        } //parseMappings
        /**
         * Capture keys from SIN
         */
        capture(which = this.sin, bind = true, out = this.sout, err = this.serr) {
            assert.ok(which.isTTY && out.isTTY && err.isTTY, "Stream must be TTY");
            if ((which.isRaw && !bind) || (!which.isRaw && bind))
                which.setRawMode(bind);
            if (this._bound.sinbind && this._bound.sin) {
                this.sin.removeListener("data", this._bound.sinbind);
                this._bound.sinbind = null;
                this.serr.write(rgl.mouseOff);
            }
            if (which.isRaw) {
                which.on("data", this._bound.sinbind = (key) => {
                    this.emit("rawkey", key);
                    this.emit("rawctrlkey", key);
                    this.emit("key", key.toString("utf8"));
                });
            }
            this._bound.sin = which;
            this._bound.sout = out;
            this._bound.serr = err;
            this.serr.write(rgl.mouseOn);
            this.emit("debug", `TTY set to ${bind}`);
            return which.isRaw;
        } //capture
        /**
         * Load package Config from File
         */
        static async load(from) {
            if (typeof from != "object") {
                let out;
                if (from) {
                    out = new RGL(await fs.readJSON(from, {
                        encoding: "ascii",
                        flag: "r"
                    }));
                }
                else {
                    try {
                        out = new RGL(await fs.readJSON(from = "./rglcfg.json", {
                            encoding: "ascii",
                            flag: "r"
                        }));
                    }
                    catch (e) {
                        out = new RGL(await fs.readJSON(from = "package.json", {
                            encoding: "ascii",
                            flag: "r"
                        }));
                    }
                }
                out.#_loadedFrom = path.resolve(from);
                return out;
            }
            else
                return new RGL(from);
        } //load
        /**
         * Store package Config to File
         */
        async store(to = this.#_loadedFrom || "./rglcfg.json", repl, pad = 2) {
            assert.ok(to && typeof to == "string", "'config' must be a valid path");
            return await fs.writeJSON(to, this.cfg, {
                EOL: os.EOL,
                encoding: "ascii",
                mode: 0o775,
                spaces: pad,
                replacer: repl,
                flag: "w"
            });
        } //store
        /**
         * Launch package entry
         */
        exec(from = this.cfg.main || "./main.js", ...data) {
            assert.ok(from, "'main' must be a valid path");
            from = path.join(process.cwd(), from);
            delete require.cache[from];
            try {
                return require(from)(this, module, ...data);
            }
            catch (e) {
                return require(this.cfg.main = path.join(process.cwd(), "./main.js"))(this, module, ...data);
            }
        } //exec
        /**
         * Write-and-count to SOUT
         */
        write(d = "", ...data) {
            if (d instanceof Buffer)
                d = d.toString("ascii");
            else if (d instanceof Uint8Array)
                d = d.join('');
            d = d.toString().replaceAll('\t', ' '.repeat(4)).replaceAll(exports.eolconv, '\n');
            const chs = d.split('\n'), len = chs.length - 1;
            d = d.replaceAll('\n', os.EOL);
            if (len >= 1)
                this.cursor[0] = chs[len].length;
            else
                this.cursor[0] += chs[len].length;
            this.cursor[0] %= this.sout.columns;
            this.cursor[1] = Math.min(this.cursor[1] + len, this.sout.rows);
            const out = this.sout.write(d);
            this.emit("write", d);
            if (!out)
                process.nextTick(() => this.sout.uncork());
            data.forEach(dt => this.write(dt));
            return out;
        } //write
        /**
         * Write-and-count-newline to SOUT
         */
        writeE(...data) {
            return this.write(data.shift(), ...data, os.EOL);
        } //writeE
        /**
         * Get TTY color depth
         */
        colorDepth(env = process.env) {
            return this.sout.getColorDepth(env);
        } //colorDepth
        /**
         * Move-and-count SOUT cursor
         */
        async move(x, y, rel = false) {
            if (!rel)
                x = Math.min(Math.max(x, 0), this.dimens[0]);
            else
                x = Math.min(Math.max(x, -this.dimens[0]), this.dimens[0]);
            if (!rel && y)
                y = Math.min(Math.max(y, 0), this.dimens[1]);
            else if (rel && y)
                y = Math.min(Math.max(y, -this.dimens[1]), this.dimens[1]);
            return new Promise((res, rej) => {
                let data;
                this.emit("move", x, y, rel);
                if (!rel) {
                    this.cursor[0] = x;
                    this.cursor[1] = y ?? this.cursor[1];
                    data = readline.cursorTo(this.sout, x, y, () => res(data));
                }
                else {
                    if (x)
                        this.cursor[0] += x;
                    if (y)
                        this.cursor[1] += y;
                    data = readline.moveCursor(this.sout, x, y ?? 0, () => res(data));
                }
            });
        } //move
        /**
         * Clear-and-restore SOUT
         */
        async clear(lines, dir = 0, rel) {
            return new Promise(async (res, rej) => {
                const sav = [...this.cursor];
                let out = true;
                if (!lines) {
                    this.move(0, 0, rel).then(() => {
                        out = readline.clearScreenDown(this.sout, () => {
                            this.move(...sav, false).then(() => res(out));
                        });
                    });
                }
                else if (typeof lines == "number" && lines < 0) {
                    out = readline.clearLine(this.sout, dir, () => {
                        this.move(...sav, false).then(() => res(out));
                    });
                }
                else if (typeof lines == "number") {
                    this.move(0, lines, rel).then(() => {
                        out = readline.clearLine(this.sout, dir, () => {
                            this.move(...sav, false).then(() => res(out));
                        });
                    });
                }
                else if (!lines.length) {
                    out = readline.clearScreenDown(this.sout, () => {
                        this.move(...sav, false).then(() => res(out));
                    });
                }
                else
                    return Promise.all(lines.map(l => this.clear(l, dir, rel))).then(bs => res(bs.every(b => b)), rej);
                this.emit("clear", lines, dir, rel, out);
            });
        } //clear
        once(eventname, listener) {
            return super.once(eventname, listener);
        } //once
        on(eventname, listener) {
            return super.on(eventname, listener);
        } //on
        emit(eventname, ...args) {
            return super.emit(eventname, ...args);
        } //emit
    } //RGL
    rgl.RGL = RGL;
})(rgl = exports.rgl || (exports.rgl = {})); //rgl
exports.default = rgl;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmdsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vbGliL3JnbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxnQ0FBZ0M7QUFFaEMsWUFBWSxDQUFDOzs7O0FBV2IsdURBQWlDO0FBQ2pDLHNEQUFnQztBQUNoQywyREFBcUM7QUFFckMscURBQStCO0FBQy9CLCtDQUF5QjtBQUN6QixtREFBNkI7QUFDN0IscURBQStCO0FBNmF0QixvQkFBSTtBQTVhYixtREFBNkI7QUFFaEIsUUFBQSxPQUFPLEdBQVcsaURBQWlELENBQUM7QUFFakYsSUFBYyxHQUFHLENBc2FoQjtBQXRhRCxXQUFjLEdBQUc7SUFFaEIsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUVqQyxHQUFHLENBQUMsT0FBTyxTQUFTLEVBQUUsQ0FBQyxDQUFDO0lBRVgsWUFBUSxHQUFHLENBQUMsS0FBc0IsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUNqRSxjQUFVLEdBQUcsQ0FBQyxLQUFzQixDQUFDLEVBQUUsRUFBRSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQ3ZELFFBQUksR0FBRyxhQUFhLEVBQ3BCLFdBQU8sR0FBRyxhQUFhLEVBQ3ZCLFdBQU8sR0FBRyw4QkFBOEIsRUFDeEMsWUFBUSxHQUFHLHdDQUF3QyxDQUFDO0lBZXJEOztPQUVHO0lBQ0gsTUFBYSxHQUFJLFNBQVEsS0FBSyxDQUFDLFlBQVk7UUEyR3ZCO1FBekduQjs7V0FFRztRQUNLLE1BQU0sR0FLVjtZQUNILEdBQUcsRUFBRSxPQUFPLENBQUMsS0FBSztZQUNsQixJQUFJLEVBQUUsT0FBTyxDQUFDLE1BQU07WUFDcEIsSUFBSSxFQUFFLE9BQU8sQ0FBQyxNQUFNO1lBQ3BCLE9BQU8sRUFBRSxJQUFJO1NBQ2IsQ0FBQztRQUNGOztXQUVHO1FBQ0gsTUFBTSxHQUFxQixDQUFFLENBQUMsRUFBRSxDQUFDLENBQUUsQ0FBQztRQUNwQzs7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QUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEMsQ0FBQyxDQUFDLE1BQU07UUFTUixFQUFFLENBQUMsU0FBMEIsRUFBRSxRQUFrQztZQUNoRSxPQUFPLEtBQUssQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQ3RDLENBQUMsQ0FBQyxJQUFJO1FBU04sSUFBSSxDQUFDLFNBQTBCLEVBQUUsR0FBRyxJQUFXO1lBQzlDLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQztRQUN2QyxDQUFDLENBQUMsTUFBTTtNQUVQLEtBQUs7SUF2WU0sT0FBRyxNQXVZZixDQUFBO0FBRUYsQ0FBQyxFQXRhYSxHQUFHLEdBQUgsV0FBRyxLQUFILFdBQUcsUUFzYWhCLENBQUMsS0FBSztBQUlQLGtCQUFlLEdBQUcsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuL1JHTE0udHNcIj5cclxuXHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuZXhwb3J0IHR5cGUgT3B0aW9uYWxzT25seTxUIGV4dGVuZHMgb2JqZWN0PiA9IFBpY2s8VCwgRXhjbHVkZTx7XHJcblx0W0sgaW4ga2V5b2YgVF0/OiBUIGV4dGVuZHMgUmVjb3JkPEssIFRbS10+ID8gbmV2ZXIgOiBLXHJcbn1ba2V5b2YgVF0sIHVuZGVmaW5lZD4+O1xyXG5leHBvcnQgdHlwZSBOb25PcHRpb25hbHM8VCBleHRlbmRzIG9iamVjdD4gPSB7XHJcblx0W2sgaW4ga2V5b2YgVF0tPzogdW5kZWZpbmVkIGV4dGVuZHMgVFtrXSA/IG5ldmVyIDoga1xyXG59W2tleW9mIFRdO1xyXG5leHBvcnQgdHlwZSBOdWxsYWJsZTxUPiA9IFQgfCBudWxsIHwgdW5kZWZpbmVkO1xyXG5leHBvcnQgdHlwZSBOdWxsYWJsZUFycmF5PFQ+ID0gWyBdIHwgVDtcclxuXHJcbmltcG9ydCAqIGFzIGFzc2VydCBmcm9tIFwiYXNzZXJ0XCI7XHJcbmltcG9ydCAqIGFzIGV2ZW50IGZyb20gXCJldmVudHNcIjtcclxuaW1wb3J0ICogYXMgcmVhZGxpbmUgZnJvbSBcInJlYWRsaW5lXCI7XHJcbmltcG9ydCAqIGFzIHR0eSBmcm9tIFwidHR5XCI7XHJcbmltcG9ydCAqIGFzIGZzIGZyb20gXCJmcy1leHRyYVwiO1xyXG5pbXBvcnQgKiBhcyBvcyBmcm9tIFwib3NcIjtcclxuaW1wb3J0ICogYXMgcGF0aCBmcm9tIFwicGF0aFwiO1xyXG5pbXBvcnQgKiBhcyByZ2xtIGZyb20gXCIuL1JHTE1cIjtcclxuaW1wb3J0ICogYXMgdXRpbCBmcm9tIFwidXRpbFwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVvbGNvbnY6IFJlZ0V4cCA9IC8oKD88IVxccilcXG4oPyFcXHIpfCg/PCFcXG4pXFxyKD8hXFxuKXxcXHJcXG58XFxuXFxyKS9nbWlzO1xyXG5cclxuZXhwb3J0IG1vZHVsZSByZ2wge1xyXG5cdFxyXG5cdGNvbnN0IGRiZyA9IHV0aWwuZGVidWdsb2coXCJSR0xcIik7XHJcblx0XHJcblx0ZGJnKGBpbnMgJHtfX2Rpcm5hbWV9YCk7XHJcblx0XHJcblx0ZXhwb3J0IGNvbnN0IHNjcm9sbFVwID0gKGJ5OiBudW1iZXIgfCBzdHJpbmcgPSAxKSA9PiBgXFx4MWJbJHtieX1TYCxcclxuXHRcdHNjcm9sbERvd24gPSAoYnk6IG51bWJlciB8IHN0cmluZyA9IDEpID0+IGBcXHgxYlske2J5fVRgLFxyXG5cdFx0c2F2ZSA9IGBcXHgxYjdcXHgxYltzYCxcclxuXHRcdHJlc3RvcmUgPSBgXFx4MWI4XFx4MWJbdWAsXHJcblx0XHRtb3VzZU9uID0gYFxceDFiWzF6XFx4MWJbPzEwMDA7MTAwMzsxMDA1aGAsXHJcblx0XHRtb3VzZU9mZiA9IGBcXHgxYlswelxceDFiWz8xMDAwOzEwMDM7MTAwNTsxMDA2OzEwMTVsYDtcclxuXHRcclxuXHQvKipcclxuXHQgKiBQYWNrYWdlIENvbmZpZ1xyXG5cdCAqL1xyXG5cdGV4cG9ydCBpbnRlcmZhY2UgUkdMQ2ZnIHtcclxuXHRcdG5hbWU6IHN0cmluZztcclxuXHRcdGRlc2NyaXB0aW9uPzogc3RyaW5nO1xyXG5cdFx0bWFpbjogc3RyaW5nO1xyXG5cdFx0dmVyc2lvbj86IHN0cmluZztcclxuXHRcdG1hcHBpbmdzPzogc3RyaW5nO1xyXG5cdFx0a2V5d29yZHM/OiBzdHJpbmdbXTtcclxuXHRcdFwiJHNjaGVtYVwiPzogc3RyaW5nO1xyXG5cdH0gLy9SR0xDZmdcclxuXHRcclxuXHQvKipcclxuXHQgKiBNYWluIHBhY2thZ2luZyBDbGFzc1xyXG5cdCAqL1xyXG5cdGV4cG9ydCBjbGFzcyBSR0wgZXh0ZW5kcyBldmVudC5FdmVudEVtaXR0ZXIge1xyXG5cdFx0XHJcblx0XHQvKipcclxuXHRcdCAqIFRUWSBzdHJlYW1zIGJvdW5kIHRvIGFwcFxyXG5cdFx0ICovXHJcblx0XHRwcml2YXRlIF9ib3VuZDoge1xyXG5cdFx0XHRzaW4/OiB0dHkuUmVhZFN0cmVhbSxcclxuXHRcdFx0c291dD86IHR0eS5Xcml0ZVN0cmVhbSxcclxuXHRcdFx0c2Vycj86IHR0eS5Xcml0ZVN0cmVhbSxcclxuXHRcdFx0c2luYmluZD86IE51bGxhYmxlPChrZXk6IEJ1ZmZlcikgPT4gYW55PixcclxuXHRcdH0gPSB7XHJcblx0XHRcdHNpbjogcHJvY2Vzcy5zdGRpbixcclxuXHRcdFx0c291dDogcHJvY2Vzcy5zdGRvdXQsXHJcblx0XHRcdHNlcnI6IHByb2Nlc3Muc3RkZXJyLFxyXG5cdFx0XHRzaW5iaW5kOiBudWxsLFxyXG5cdFx0fTtcclxuXHRcdC8qKlxyXG5cdFx0ICogU09VVCBjdXJzb3Igc3RhdGVcclxuXHRcdCAqL1xyXG5cdFx0Y3Vyc29yOiBbbnVtYmVyLCBudW1iZXJdID0gWyAwLCAwIF07XHJcblx0XHQvKipcclxuXHRcdCAqIFNvdXJjZSBvZiBwYWNrYWdlIENvbmZpZyBpbiBjYXNlIG9mIGZzIGxvYWRcclxuXHRcdCAqL1xyXG5cdFx0I19sb2FkZWRGcm9tOiBzdHJpbmcgPSBcIlwiO1xyXG5cdFx0XHJcblx0XHRzdGF0aWMgcmVhZG9ubHkgZGVmYXVsdHM6IFJHTENmZyA9IHtcclxuXHRcdFx0ZGVzY3JpcHRpb246IFwiXCIsXHJcblx0XHRcdG1haW46IFwiLi9tYWluLmpzXCIsXHJcblx0XHRcdHZlcnNpb246IFwiMC4xXCIsXHJcblx0XHRcdG1hcHBpbmdzOiBcIi4vbWFwcGluZ3MuanNcIixcclxuXHRcdFx0bmFtZTogcHJvY2Vzcy50aXRsZSxcclxuXHRcdFx0a2V5d29yZHM6IFsgXSxcclxuXHRcdFx0XCIkc2NoZW1hXCI6IHBhdGguam9pbihfX2Rpcm5hbWUsIFwiLi4vLi4vcmdsY2ZnLnNjaGVtYS5qc29uXCIpXHJcblx0XHR9O1xyXG5cdFx0LyoqXHJcblx0XHQgKiBTcGVjaWFsIGtleXMgZm9yIGNvbnZlbmllbmNlXHJcblx0XHQgKi9cclxuXHRcdHN0YXRpYyByZWFkb25seSBzcGVjaWFsX2tleXM6IHtcclxuXHRcdFx0Y3RybEM6XHRcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdGN0cmxWOlx0XHRcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRjdHJsWjpcdFx0XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdFx0Y3RybFk6XHRcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdHVwOlx0XHRcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdGRvd246XHRcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdHJpZ2h0Olx0XHRcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRsZWZ0Olx0XHRcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRzaGlmdFVwOlx0XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdFx0c2hpZnREb3duOlx0XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdFx0c2hpZnRSaWdodDpcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdHNoaWZ0TGVmdDpcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdGN0cmxVcDpcdFx0XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdFx0Y3RybERvd246XHRcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRjdHJsUmlnaHQ6XHRcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRjdHJsTGVmdDpcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdGZuVXA6XHRcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdGZuRG93bjpcdFx0XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdFx0Zm5MZWZ0Olx0XHRcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRmblJpZ2h0Olx0XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdFx0Y3RybFNoaWZ0VXA6XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdFx0Y3RybFNoaWZ0RG93bjpcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRjdHJsU2hpZnRSaWdodDpcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRjdHJsU2hpZnRMZWZ0Olx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdGN0cmxGblVwOlx0XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdFx0Y3RybEZuRG93bjpcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdGN0cmxGblJpZ2h0Olx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdGN0cmxGbkxlZnQ6XHRcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRlbnRlcjpcdFx0XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdFx0YWx0RW50ZXI6XHRcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRiYWNrOlx0XHRcdFJlYWRvbmx5PE5vbk51bGxhYmxlPEJ1ZmZlcj4+O1xyXG5cdFx0XHRkZWw6XHRcdFx0UmVhZG9ubHk8Tm9uTnVsbGFibGU8QnVmZmVyPj47XHJcblx0XHRcdHRhYjpcdFx0XHRSZWFkb25seTxOb25OdWxsYWJsZTxCdWZmZXI+PjtcclxuXHRcdH0gPSB7XHJcblx0XHRcdGN0cmxDOlx0XHRcdEJ1ZmZlci5mcm9tKFwiMDNcIixcdFx0XHRcImhleFwiKSxcclxuXHRcdFx0Y3RybFY6XHRcdFx0QnVmZmVyLmZyb20oXCIxNlwiLFx0XHRcdFwiaGV4XCIpLFxyXG5cdFx0XHRjdHJsWjpcdFx0XHRCdWZmZXIuZnJvbShcIjFhXCIsXHRcdFx0XCJoZXhcIiksXHJcblx0XHRcdGN0cmxZOlx0XHRcdEJ1ZmZlci5mcm9tKFwiMTlcIixcdFx0XHRcImhleFwiKSxcclxuXHRcdFx0dXA6XHRcdFx0XHRCdWZmZXIuZnJvbShcIjFiNWI0MVwiLFx0XHRcImhleFwiKSxcclxuXHRcdFx0ZG93bjpcdFx0XHRCdWZmZXIuZnJvbShcIjFiNWI0MlwiLFx0XHRcImhleFwiKSxcclxuXHRcdFx0cmlnaHQ6XHRcdFx0QnVmZmVyLmZyb20oXCIxYjViNDNcIixcdFx0XCJoZXhcIiksXHJcblx0XHRcdGxlZnQ6XHRcdFx0QnVmZmVyLmZyb20oXCIxYjViNDRcIixcdFx0XCJoZXhcIiksXHJcblx0XHRcdHNoaWZ0VXA6XHRcdEJ1ZmZlci5mcm9tKFwiMWI1YjMxM2IzMjQxXCIsXHRcImhleFwiKSxcclxuXHRcdFx0c2hpZnREb3duOlx0XHRCdWZmZXIuZnJvbShcIjFiNWIzMTNiMzI0MlwiLFx0XCJoZXhcIiksXHJcblx0XHRcdHNoaWZ0UmlnaHQ6XHRcdEJ1ZmZlci5mcm9tKFwiMWI1YjMxM2IzMjQzXCIsXHRcImhleFwiKSxcclxuXHRcdFx0c2hpZnRMZWZ0Olx0XHRCdWZmZXIuZnJvbShcIjFiNWIzMTNiMzI0NFwiLFx0XCJoZXhcIiksXHJcblx0XHRcdGN0cmxVcDpcdFx0XHRCdWZmZXIuZnJvbShcIjFiNWIzMTNiMzU0MVwiLFx0XCJoZXhcIiksXHJcblx0XHRcdGN0cmxEb3duOlx0XHRCdWZmZXIuZnJvbShcIjFiNWIzMTNiMzU0MlwiLFx0XCJoZXhcIiksXHJcblx0XHRcdGN0cmxSaWdodDpcdFx0QnVmZmVyLmZyb20oXCIxYjViMzEzYjM1NDNcIixcdFwiaGV4XCIpLFxyXG5cdFx0XHRjdHJsTGVmdDpcdFx0QnVmZmVyLmZyb20oXCIxYjViMzEzYjM1NDRcIixcdFwiaGV4XCIpLFxyXG5cdFx0XHRmblVwOlx0XHRcdEJ1ZmZlci5mcm9tKFwiMWI1YjM1N2VcIixcdFx0XCJoZXhcIiksXHJcblx0XHRcdGZuRG93bjpcdFx0XHRCdWZmZXIuZnJvbShcIjFiNWIzNjdlXCIsXHRcdFwiaGV4XCIpLFxyXG5cdFx0XHRmblJpZ2h0Olx0XHRCdWZmZXIuZnJvbShcIjFiNWIzNDdlXCIsXHRcdFwiaGV4XCIpLFxyXG5cdFx0XHRmbkxlZnQ6XHRcdFx0QnVmZmVyLmZyb20oXCIxYjViMzE3ZVwiLFx0XHRcImhleFwiKSxcclxuXHRcdFx0Y3RybFNoaWZ0VXA6XHRCdWZmZXIuZnJvbShcIjFiNWIzMTNiMzY0MVwiLFx0XCJoZXhcIiksXHJcblx0XHRcdGN0cmxTaGlmdERvd246XHRCdWZmZXIuZnJvbShcIjFiNWIzMTNiMzY0MlwiLFx0XCJoZXhcIiksXHJcblx0XHRcdGN0cmxTaGlmdFJpZ2h0Olx0QnVmZmVyLmZyb20oXCIxYjViMzEzYjM2NDNcIixcdFwiaGV4XCIpLFxyXG5cdFx0XHRjdHJsU2hpZnRMZWZ0Olx0QnVmZmVyLmZyb20oXCIxYjViMzEzYjM2NDRcIixcdFwiaGV4XCIpLFxyXG5cdFx0XHRjdHJsRm5VcDpcdFx0QnVmZmVyLmZyb20oXCIxYjViMzUzYjM1N2VcIixcdFwiaGV4XCIpLFxyXG5cdFx0XHRjdHJsRm5Eb3duOlx0XHRCdWZmZXIuZnJvbShcIjFiNWIzNjNiMzU3ZVwiLFx0XCJoZXhcIiksXHJcblx0XHRcdGN0cmxGblJpZ2h0Olx0QnVmZmVyLmZyb20oXCIxYjViMzQzYjM1N2VcIixcdFwiaGV4XCIpLFxyXG5cdFx0XHRjdHJsRm5MZWZ0Olx0XHRCdWZmZXIuZnJvbShcIjFiNWIzMTNiMzU3ZVwiLFx0XCJoZXhcIiksXHJcblx0XHRcdGVudGVyOlx0XHRcdEJ1ZmZlci5mcm9tKFwiMGRcIixcdFx0XHRcImhleFwiKSwgLy8wZCA9IFxcciwgMGEgPSBcXG5cclxuXHRcdFx0YWx0RW50ZXI6XHRcdEJ1ZmZlci5mcm9tKFwiMWIwZFwiLFx0XHRcdFwiaGV4XCIpLCAvLytjdHJsQWx0RW50ZXIgK3NoaWZ0QWx0RW50ZXJcclxuXHRcdFx0YmFjazpcdFx0XHRCdWZmZXIuZnJvbShcIjA4XCIsXHRcdFx0XCJoZXhcIiksIC8vK2N0cmxIXHJcblx0XHRcdGRlbDpcdFx0XHRCdWZmZXIuZnJvbShcIjFiNWIzMzdlXCIsXHRcdFwiaGV4XCIpLFxyXG5cdFx0XHR0YWI6XHRcdFx0QnVmZmVyLmZyb20oXCIwOVwiLFx0XHRcdFwiaGV4XCIpLFxyXG5cdFx0fTtcclxuXHRcdFxyXG5cdFx0Y29uc3RydWN0b3IocHVibGljIGNmZzogUGFydGlhbDxSR0xDZmc+KSB7XHJcblx0XHRcdHN1cGVyKCk7XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLmNmZyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKG51bGwpLCBSR0wuZGVmYXVsdHMpLCBjZmcpO1xyXG5cdFx0XHRcclxuXHRcdFx0YXNzZXJ0Lm9rKHRoaXMuY2ZnLm5hbWUsIFwiUkdMICduYW1lJyBtdXN0IGJlIHByb3ZpZGVkIGluIHRoZSBjb25maWdcIik7XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLmNmZy5tYWluXHRcdD0gXCIuL1wiICsgcGF0aC5ub3JtYWxpemUodGhpcy5jZmcubWFpblx0XHR8fCBSR0wuZGVmYXVsdHMubWFpbik7XHJcblx0XHRcdHRoaXMuY2ZnLm1hcHBpbmdzXHQ9IFwiLi9cIiArIHBhdGgubm9ybWFsaXplKHRoaXMuY2ZnLm1hcHBpbmdzXHR8fCBSR0wuZGVmYXVsdHMubWFwcGluZ3MgfHwgXCIuL21hcHBpbmdzLmpzXCIpO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly9wcm9jZXNzLnN0ZG91dC53cml0ZShgXFx4MWJdMDske3RoaXMuY2ZnLm5hbWV9XFxhYCk7XHJcblx0XHRcdHByb2Nlc3MudGl0bGUgPSB0aGlzLmNmZy5uYW1lIHx8IHByb2Nlc3MudGl0bGUgfHwgXCJSR0xcIjtcclxuXHRcdFx0XHJcblx0XHRcdHRoaXMucGFyc2VNYXBwaW5ncygpO1xyXG5cdFx0fSAvL2N0b3JcclxuXHRcdFxyXG5cdFx0Z2V0IGRpbWVucygpOiBbbnVtYmVyLCBudW1iZXJdIHwgWzAsIDBdIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuc291dD8uZ2V0V2luZG93U2l6ZSgpIHx8IFswLCAwXTtcclxuXHRcdH0gLy9nLWRpbWVuc1xyXG5cdFx0Z2V0IGNEcHQoKTogbnVtYmVyIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuY29sb3JEZXB0aCgpO1xyXG5cdFx0fSAvL2ctY0RwdFxyXG5cdFx0Z2V0IHNlcnIoKTogdHR5LldyaXRlU3RyZWFtIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuX2JvdW5kLnNlcnIgfHwgdGhpcy5fYm91bmQuc291dCB8fCBwcm9jZXNzLnN0ZGVycjtcclxuXHRcdH0gLy9nLXNlcnJcclxuXHRcdGdldCBzb3V0KCk6IHR0eS5Xcml0ZVN0cmVhbSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9ib3VuZC5zb3V0IHx8IHByb2Nlc3Muc3Rkb3V0O1xyXG5cdFx0fSAvL2ctc291dFxyXG5cdFx0Z2V0IHNpbigpOiB0dHkuUmVhZFN0cmVhbSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9ib3VuZC5zaW4gfHwgcHJvY2Vzcy5zdGRpbjtcclxuXHRcdH0gLy9nLXNpblxyXG5cdFx0XHJcblx0XHQvKipcclxuXHRcdCAqIFBhcnNlIE1hcHBpbmdzIGZyb20gRmlsZVxyXG5cdFx0ICovXHJcblx0XHRwYXJzZU1hcHBpbmdzKGZyb206IE51bGxhYmxlPHN0cmluZz4gPSB0aGlzLmNmZy5tYXBwaW5ncyk6IE9iamVjdCB7XHJcblx0XHRcdGFzc2VydC5vayhmcm9tLCBcIidtYXBwaW5ncycgbXVzdCBiZSBhIHZhbGlkIHBhdGhcIik7XHJcblx0XHRcdFxyXG5cdFx0XHRmcm9tID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIGZyb20pO1xyXG5cdFx0XHRcclxuXHRcdFx0ZGVsZXRlIHJlcXVpcmUuY2FjaGVbZnJvbV07XHJcblx0XHRcdFxyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdHJldHVybiByZ2xtLlJHTE0uUkdMTUNodW5rLm1hcHBpbmdzID0gcmVxdWlyZShmcm9tKTtcclxuXHRcdFx0fSBjYXRjaChlKSB7XHJcblx0XHRcdFx0cmV0dXJuIHJnbG0uUkdMTS5SR0xNQ2h1bmsubWFwcGluZ3MgPSByZXF1aXJlKHRoaXMuY2ZnLm1hcHBpbmdzID0gcGF0aC5qb2luKF9fZGlybmFtZSwgXCIuLi8uLi9tYXBwaW5ncy5qc1wiKSk7XHJcblx0XHRcdH1cclxuXHRcdH0gLy9wYXJzZU1hcHBpbmdzXHJcblx0XHRcclxuXHRcdC8qKlxyXG5cdFx0ICogQ2FwdHVyZSBrZXlzIGZyb20gU0lOXHJcblx0XHQgKi9cclxuXHRcdGNhcHR1cmUod2hpY2g6IHR0eS5SZWFkU3RyZWFtID0gdGhpcy5zaW4sIGJpbmQgPSB0cnVlLCBvdXQ6IHR0eS5Xcml0ZVN0cmVhbSA9IHRoaXMuc291dCwgZXJyOiB0dHkuV3JpdGVTdHJlYW0gPSB0aGlzLnNlcnIpOiBib29sZWFuIHtcclxuXHRcdFx0YXNzZXJ0Lm9rKHdoaWNoLmlzVFRZICYmIG91dC5pc1RUWSAmJiBlcnIuaXNUVFksIFwiU3RyZWFtIG11c3QgYmUgVFRZXCIpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKCh3aGljaC5pc1JhdyAmJiAhYmluZCkgfHwgKCF3aGljaC5pc1JhdyAmJiBiaW5kKSkgd2hpY2guc2V0UmF3TW9kZShiaW5kKTtcclxuXHRcdFx0XHJcblx0XHRcdGlmICh0aGlzLl9ib3VuZC5zaW5iaW5kICYmIHRoaXMuX2JvdW5kLnNpbikge1xyXG5cdFx0XHRcdHRoaXMuc2luLnJlbW92ZUxpc3RlbmVyKFwiZGF0YVwiLCB0aGlzLl9ib3VuZC5zaW5iaW5kISk7XHJcblx0XHRcdFx0dGhpcy5fYm91bmQuc2luYmluZCA9IG51bGw7XHJcblx0XHRcdFx0dGhpcy5zZXJyLndyaXRlKHJnbC5tb3VzZU9mZik7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdGlmICh3aGljaC5pc1Jhdykge1xyXG5cdFx0XHRcdHdoaWNoLm9uKFwiZGF0YVwiLCB0aGlzLl9ib3VuZC5zaW5iaW5kID0gKGtleTogQnVmZmVyKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLmVtaXQoXCJyYXdrZXlcIiwga2V5KTtcclxuXHRcdFx0XHRcdHRoaXMuZW1pdChcInJhd2N0cmxrZXlcIiwga2V5KTtcclxuXHRcdFx0XHRcdHRoaXMuZW1pdChcImtleVwiLCBrZXkudG9TdHJpbmcoXCJ1dGY4XCIpKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5fYm91bmQuc2luID0gd2hpY2g7XHJcblx0XHRcdHRoaXMuX2JvdW5kLnNvdXQgPSBvdXQ7XHJcblx0XHRcdHRoaXMuX2JvdW5kLnNlcnIgPSBlcnI7XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLnNlcnIud3JpdGUocmdsLm1vdXNlT24pO1xyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5lbWl0KFwiZGVidWdcIiwgYFRUWSBzZXQgdG8gJHtiaW5kfWApO1xyXG5cdFx0XHRcclxuXHRcdFx0cmV0dXJuIHdoaWNoLmlzUmF3O1xyXG5cdFx0fSAvL2NhcHR1cmVcclxuXHRcdFxyXG5cdFx0LyoqXHJcblx0XHQgKiBMb2FkIHBhY2thZ2UgQ29uZmlnIGZyb20gRmlsZVxyXG5cdFx0ICovXHJcblx0XHRzdGF0aWMgYXN5bmMgbG9hZChmcm9tPzogc3RyaW5nIHwgUGFydGlhbDxSR0xDZmc+KTogUHJvbWlzZTxSR0w+IHtcclxuXHRcdFx0aWYgKHR5cGVvZiBmcm9tICE9IFwib2JqZWN0XCIpIHtcclxuXHRcdFx0XHRsZXQgb3V0OiBSR0w7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aWYgKGZyb20pIHtcclxuXHRcdFx0XHRcdG91dCA9IG5ldyBSR0woYXdhaXQgZnMucmVhZEpTT04oZnJvbSwge1xyXG5cdFx0XHRcdFx0XHRlbmNvZGluZzogXCJhc2NpaVwiLFxyXG5cdFx0XHRcdFx0XHRmbGFnOiBcInJcIlxyXG5cdFx0XHRcdFx0fSkpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRvdXQgPSBuZXcgUkdMKGF3YWl0IGZzLnJlYWRKU09OKGZyb20gPSBcIi4vcmdsY2ZnLmpzb25cIiwge1xyXG5cdFx0XHRcdFx0XHRcdGVuY29kaW5nOiBcImFzY2lpXCIsXHJcblx0XHRcdFx0XHRcdFx0ZmxhZzogXCJyXCJcclxuXHRcdFx0XHRcdFx0fSkpO1xyXG5cdFx0XHRcdFx0fSBjYXRjaChlKSB7XHJcblx0XHRcdFx0XHRcdG91dCA9IG5ldyBSR0woYXdhaXQgZnMucmVhZEpTT04oZnJvbSA9IFwicGFja2FnZS5qc29uXCIsIHtcclxuXHRcdFx0XHRcdFx0XHRlbmNvZGluZzogXCJhc2NpaVwiLFxyXG5cdFx0XHRcdFx0XHRcdGZsYWc6IFwiclwiXHJcblx0XHRcdFx0XHRcdH0pKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0b3V0LiNfbG9hZGVkRnJvbSA9IHBhdGgucmVzb2x2ZShmcm9tKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRyZXR1cm4gb3V0O1xyXG5cdFx0XHR9IGVsc2UgcmV0dXJuIG5ldyBSR0woZnJvbSk7XHJcblx0XHR9IC8vbG9hZFxyXG5cdFx0LyoqXHJcblx0XHQgKiBTdG9yZSBwYWNrYWdlIENvbmZpZyB0byBGaWxlXHJcblx0XHQgKi9cclxuXHRcdGFzeW5jIHN0b3JlKHRvOiBzdHJpbmcgPSB0aGlzLiNfbG9hZGVkRnJvbSB8fCBcIi4vcmdsY2ZnLmpzb25cIiwgcmVwbD86ICgodGhpczogYW55LCBrZXk6IHN0cmluZywgdmFsdWU6IG51bWJlcikgPT4gYW55KSwgcGFkOiBudW1iZXIgPSAyKTogUHJvbWlzZTxhbnk+IHtcclxuXHRcdFx0YXNzZXJ0Lm9rKHRvICYmIHR5cGVvZiB0byA9PSBcInN0cmluZ1wiLCBcIidjb25maWcnIG11c3QgYmUgYSB2YWxpZCBwYXRoXCIpO1xyXG5cdFx0XHRcclxuXHRcdFx0cmV0dXJuIGF3YWl0IGZzLndyaXRlSlNPTih0bywgdGhpcy5jZmcsIHtcclxuXHRcdFx0XHRFT0w6IG9zLkVPTCxcclxuXHRcdFx0XHRlbmNvZGluZzogXCJhc2NpaVwiLFxyXG5cdFx0XHRcdG1vZGU6IDBvNzc1LFxyXG5cdFx0XHRcdHNwYWNlczogcGFkLFxyXG5cdFx0XHRcdHJlcGxhY2VyOiByZXBsLFxyXG5cdFx0XHRcdGZsYWc6IFwid1wiXHJcblx0XHRcdH0pO1xyXG5cdFx0fSAvL3N0b3JlXHJcblx0XHRcclxuXHRcdC8qKlxyXG5cdFx0ICogTGF1bmNoIHBhY2thZ2UgZW50cnlcclxuXHRcdCAqL1xyXG5cdFx0ZXhlYyhmcm9tOiBOdWxsYWJsZTxzdHJpbmc+ID0gdGhpcy5jZmcubWFpbiB8fCBcIi4vbWFpbi5qc1wiLCAuLi5kYXRhOiBhbnlbXSk6IGFueXtcclxuXHRcdFx0YXNzZXJ0Lm9rKGZyb20sIFwiJ21haW4nIG11c3QgYmUgYSB2YWxpZCBwYXRoXCIpO1xyXG5cdFx0XHRcclxuXHRcdFx0ZnJvbSA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBmcm9tKTtcclxuXHRcdFx0XHJcblx0XHRcdGRlbGV0ZSByZXF1aXJlLmNhY2hlW2Zyb21dO1xyXG5cdFx0XHRcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRyZXR1cm4gcmVxdWlyZShmcm9tKSh0aGlzLCBtb2R1bGUsIC4uLmRhdGEpO1xyXG5cdFx0XHR9IGNhdGNoKGUpIHtcclxuXHRcdFx0XHRyZXR1cm4gcmVxdWlyZSh0aGlzLmNmZy5tYWluID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwiLi9tYWluLmpzXCIpKSh0aGlzLCBtb2R1bGUsIC4uLmRhdGEpO1xyXG5cdFx0XHR9XHJcblx0XHR9IC8vZXhlY1xyXG5cdFx0XHJcblx0XHQvKipcclxuXHRcdCAqIFdyaXRlLWFuZC1jb3VudCB0byBTT1VUXHJcblx0XHQgKi9cclxuXHRcdHdyaXRlKGQ6IHN0cmluZyB8IFVpbnQ4QXJyYXkgfCBCdWZmZXIgPSBcIlwiLCAuLi5kYXRhOiAoc3RyaW5nIHwgVWludDhBcnJheSlbXSk6IGJvb2xlYW4ge1xyXG5cdFx0XHRpZiAoZCBpbnN0YW5jZW9mIEJ1ZmZlcikgZCA9IGQudG9TdHJpbmcoXCJhc2NpaVwiKTtcclxuXHRcdFx0ZWxzZSBpZiAoZCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIGQgPSBkLmpvaW4oJycpO1xyXG5cdFx0XHRcclxuXHRcdFx0ZCA9IGQudG9TdHJpbmcoKS5yZXBsYWNlQWxsKCdcXHQnLCAnICcucmVwZWF0KDQpKS5yZXBsYWNlQWxsKGVvbGNvbnYsICdcXG4nKTtcclxuXHRcdFx0XHJcblx0XHRcdGNvbnN0IGNoczogc3RyaW5nW10gPSBkLnNwbGl0KCdcXG4nKSxcclxuXHRcdFx0XHRsZW46IG51bWJlciA9IGNocy5sZW5ndGggLSAxO1xyXG5cdFx0XHRcclxuXHRcdFx0ZCA9IGQucmVwbGFjZUFsbCgnXFxuJywgb3MuRU9MKTtcclxuXHRcdFx0XHJcblx0XHRcdGlmIChsZW4gPj0gMSkgdGhpcy5jdXJzb3JbMF0gPSBjaHNbbGVuXS5sZW5ndGg7XHJcblx0XHRcdGVsc2UgdGhpcy5jdXJzb3JbMF0gKz0gY2hzW2xlbl0ubGVuZ3RoO1xyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5jdXJzb3JbMF0gJT0gdGhpcy5zb3V0LmNvbHVtbnM7XHJcblx0XHRcdHRoaXMuY3Vyc29yWzFdID0gTWF0aC5taW4odGhpcy5jdXJzb3JbMV0gKyBsZW4sIHRoaXMuc291dC5yb3dzKTtcclxuXHRcdFx0XHJcblx0XHRcdGNvbnN0IG91dDogYm9vbGVhbiA9IHRoaXMuc291dC53cml0ZShkKTtcclxuXHRcdFx0XHJcblx0XHRcdHRoaXMuZW1pdChcIndyaXRlXCIsIGQpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKCFvdXQpIHByb2Nlc3MubmV4dFRpY2soKCkgPT4gdGhpcy5zb3V0LnVuY29yaygpKTtcclxuXHRcdFx0XHJcblx0XHRcdGRhdGEuZm9yRWFjaChkdCA9PiB0aGlzLndyaXRlKGR0KSk7XHJcblx0XHRcdFxyXG5cdFx0XHRyZXR1cm4gb3V0O1xyXG5cdFx0fSAvL3dyaXRlXHJcblx0XHQvKipcclxuXHRcdCAqIFdyaXRlLWFuZC1jb3VudC1uZXdsaW5lIHRvIFNPVVRcclxuXHRcdCAqL1xyXG5cdFx0d3JpdGVFKC4uLmRhdGE6IChzdHJpbmcgfCBVaW50OEFycmF5IHwgQnVmZmVyKVtdKTogYm9vbGVhbiB7XHJcblx0XHRcdHJldHVybiB0aGlzLndyaXRlKGRhdGEuc2hpZnQoKSEsIC4uLmRhdGEsIG9zLkVPTCk7XHJcblx0XHR9IC8vd3JpdGVFXHJcblx0XHRcclxuXHRcdC8qKlxyXG5cdFx0ICogR2V0IFRUWSBjb2xvciBkZXB0aFxyXG5cdFx0ICovXHJcblx0XHRjb2xvckRlcHRoKGVudjogTm9kZUpTLlByb2Nlc3NFbnYgPSBwcm9jZXNzLmVudik6IG51bWJlciB7XHJcblx0XHRcdHJldHVybiB0aGlzLnNvdXQuZ2V0Q29sb3JEZXB0aChlbnYpO1xyXG5cdFx0fSAvL2NvbG9yRGVwdGhcclxuXHRcdFxyXG5cdFx0LyoqXHJcblx0XHQgKiBNb3ZlLWFuZC1jb3VudCBTT1VUIGN1cnNvclxyXG5cdFx0ICovXHJcblx0XHRhc3luYyBtb3ZlKHg6IG51bWJlciwgeT86IG51bWJlciwgcmVsOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuXHRcdFx0aWYgKCFyZWwpIHggPSBNYXRoLm1pbihNYXRoLm1heCh4LCAwKSwgdGhpcy5kaW1lbnNbMF0pO1xyXG5cdFx0XHRlbHNlIHggPSBNYXRoLm1pbihNYXRoLm1heCh4LCAtdGhpcy5kaW1lbnNbMF0pLCB0aGlzLmRpbWVuc1swXSk7XHJcblx0XHRcdGlmICghcmVsICYmIHkpIHkgPSBNYXRoLm1pbihNYXRoLm1heCh5LCAwKSwgdGhpcy5kaW1lbnNbMV0pO1xyXG5cdFx0XHRlbHNlIGlmIChyZWwgJiYgeSkgeSA9IE1hdGgubWluKE1hdGgubWF4KHksIC10aGlzLmRpbWVuc1sxXSksIHRoaXMuZGltZW5zWzFdKTtcclxuXHRcdFx0XHJcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHtcclxuXHRcdFx0XHRsZXQgZGF0YTogYm9vbGVhbjtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHR0aGlzLmVtaXQoXCJtb3ZlXCIsIHgsIHksIHJlbCk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aWYgKCFyZWwpIHtcclxuXHRcdFx0XHRcdHRoaXMuY3Vyc29yWzBdID0geDtcclxuXHRcdFx0XHRcdHRoaXMuY3Vyc29yWzFdID0geSA/PyB0aGlzLmN1cnNvclsxXTtcclxuXHRcdFx0XHRcdGRhdGEgPSByZWFkbGluZS5jdXJzb3JUbyh0aGlzLnNvdXQsIHgsIHksICgpID0+IHJlcyhkYXRhKSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGlmICh4KSB0aGlzLmN1cnNvclswXSArPSB4O1xyXG5cdFx0XHRcdFx0aWYgKHkpIHRoaXMuY3Vyc29yWzFdICs9IHk7XHJcblx0XHRcdFx0XHRkYXRhID0gcmVhZGxpbmUubW92ZUN1cnNvcih0aGlzLnNvdXQsIHgsIHkgPz8gMCwgKCkgPT4gcmVzKGRhdGEpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSAvL21vdmVcclxuXHRcdC8qKlxyXG5cdFx0ICogQ2xlYXItYW5kLXJlc3RvcmUgU09VVFxyXG5cdFx0ICovXHJcblx0XHRhc3luYyBjbGVhcihsaW5lcz86IG51bWJlcltdIHwgbnVtYmVyLCBkaXI6IHR0eS5EaXJlY3Rpb24gPSAwLCByZWw/OiBib29sZWFuKTogUHJvbWlzZTxib29sZWFuPiB7XHJcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzLCByZWopID0+IHtcclxuXHRcdFx0XHRjb25zdCBzYXY6IFtudW1iZXIsIG51bWJlcl0gPSBbLi4udGhpcy5jdXJzb3JdO1xyXG5cdFx0XHRcdGxldCBvdXQ6IGJvb2xlYW4gPSB0cnVlO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGlmICghbGluZXMpIHtcclxuXHRcdFx0XHRcdHRoaXMubW92ZSgwLCAwLCByZWwpLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRvdXQgPSByZWFkbGluZS5jbGVhclNjcmVlbkRvd24odGhpcy5zb3V0LCAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5tb3ZlKC4uLnNhdiwgZmFsc2UpLnRoZW4oKCkgPT4gcmVzKG91dCkpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAodHlwZW9mIGxpbmVzID09IFwibnVtYmVyXCIgJiYgbGluZXMgPCAwKSB7XHJcblx0XHRcdFx0XHRvdXQgPSByZWFkbGluZS5jbGVhckxpbmUodGhpcy5zb3V0LCBkaXIsICgpID0+IHtcclxuXHRcdFx0XHRcdFx0dGhpcy5tb3ZlKC4uLnNhdiwgZmFsc2UpLnRoZW4oKCkgPT4gcmVzKG91dCkpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgbGluZXMgPT0gXCJudW1iZXJcIikge1xyXG5cdFx0XHRcdFx0dGhpcy5tb3ZlKDAsIGxpbmVzLCByZWwpLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRvdXQgPSByZWFkbGluZS5jbGVhckxpbmUodGhpcy5zb3V0LCBkaXIsICgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLm1vdmUoLi4uc2F2LCBmYWxzZSkudGhlbigoKSA9PiByZXMob3V0KSk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICghbGluZXMubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRvdXQgPSByZWFkbGluZS5jbGVhclNjcmVlbkRvd24odGhpcy5zb3V0LCAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMubW92ZSguLi5zYXYsIGZhbHNlKS50aGVuKCgpID0+IHJlcyhvdXQpKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0gZWxzZVxyXG5cdFx0XHRcdFx0cmV0dXJuIFByb21pc2UuYWxsKGxpbmVzLm1hcChsID0+IHRoaXMuY2xlYXIobCwgZGlyLCByZWwpKSkudGhlbihicyA9PiByZXMoYnMuZXZlcnkoYiA9PiBiKSksIHJlaik7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0dGhpcy5lbWl0KFwiY2xlYXJcIiwgbGluZXMsIGRpciwgcmVsLCBvdXQpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gLy9jbGVhclxyXG5cdFx0XHJcblx0XHRvbmNlKGV2ZW50bmFtZTogXCJsb2dcIiwgbGlzdGVuZXI6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCk6IHRoaXM7XHJcblx0XHRvbmNlKGV2ZW50bmFtZTogXCJkZWJ1Z1wiLCBsaXN0ZW5lcjogKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkKTogdGhpcztcclxuXHRcdG9uY2UoZXZlbnRuYW1lOiBcImNsZWFyXCIsIGxpc3RlbmVyOiAobGluZXM6IG51bWJlciwgZGlyOiB0dHkuRGlyZWN0aW9uLCByZWw6IGJvb2xlYW4sIG91dDogYm9vbGVhbikgPT4gdm9pZCk6IHRoaXM7XHJcblx0XHRvbmNlKGV2ZW50bmFtZTogXCJ3cml0ZVwiLCBsaXN0ZW5lcjogKGQ6IHN0cmluZyB8IFVpbnQ4QXJyYXkpID0+IHZvaWQpOiB0aGlzO1xyXG5cdFx0b25jZShldmVudG5hbWU6IFwibW92ZVwiLCBsaXN0ZW5lcjogKHg6IG51bWJlciwgeTogbnVtYmVyLCByZWw6IGJvb2xlYW4pID0+IHZvaWQpOiB0aGlzO1xyXG5cdFx0b25jZShldmVudG5hbWU6IFwia2V5XCIsIGxpc3RlbmVyOiAoa2V5OiBzdHJpbmcpID0+IHN0cmluZyk6IHRoaXM7XHJcblx0XHRvbmNlKGV2ZW50bmFtZTogXCJyYXdrZXlcIiwgbGlzdGVuZXI6IChrZXk6IEJ1ZmZlcikgPT4gQnVmZmVyKTogdGhpcztcclxuXHRcdG9uY2UoZXZlbnRuYW1lOiBzdHJpbmcgfCBzeW1ib2wsIGxpc3RlbmVyOiAoLi4uYXJnczogYW55W10pID0+IHZvaWQpOiB0aGlzO1xyXG5cdFx0b25jZShldmVudG5hbWU6IHN0cmluZyB8IHN5bWJvbCwgbGlzdGVuZXI6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCk6IHRoaXMge1xyXG5cdFx0XHRyZXR1cm4gc3VwZXIub25jZShldmVudG5hbWUsIGxpc3RlbmVyKTtcclxuXHRcdH0gLy9vbmNlXHJcblx0XHRvbihldmVudG5hbWU6IFwibG9nXCIsIGxpc3RlbmVyOiAoLi4uYXJnczogYW55W10pID0+IHZvaWQpOiB0aGlzO1xyXG5cdFx0b24oZXZlbnRuYW1lOiBcImRlYnVnXCIsIGxpc3RlbmVyOiAoLi4uYXJnczogYW55W10pID0+IHZvaWQpOiB0aGlzO1xyXG5cdFx0b24oZXZlbnRuYW1lOiBcImNsZWFyXCIsIGxpc3RlbmVyOiAobGluZXM6IG51bWJlciwgZGlyOiB0dHkuRGlyZWN0aW9uLCByZWw6IGJvb2xlYW4sIG91dDogYm9vbGVhbikgPT4gdm9pZCk6IHRoaXM7XHJcblx0XHRvbihldmVudG5hbWU6IFwid3JpdGVcIiwgbGlzdGVuZXI6IChkOiBzdHJpbmcgfCBVaW50OEFycmF5KSA9PiB2b2lkKTogdGhpcztcclxuXHRcdG9uKGV2ZW50bmFtZTogXCJtb3ZlXCIsIGxpc3RlbmVyOiAoeDogbnVtYmVyLCB5OiBudW1iZXIsIHJlbDogYm9vbGVhbikgPT4gdm9pZCk6IHRoaXM7XHJcblx0XHRvbihldmVudG5hbWU6IFwia2V5XCIsIGxpc3RlbmVyOiAoa2V5OiBzdHJpbmcpID0+IHN0cmluZyk6IHRoaXM7XHJcblx0XHRvbihldmVudG5hbWU6IFwicmF3a2V5XCIsIGxpc3RlbmVyOiAoa2V5OiBCdWZmZXIpID0+IEJ1ZmZlcik6IHRoaXM7XHJcblx0XHRvbihldmVudG5hbWU6IHN0cmluZyB8IHN5bWJvbCwgbGlzdGVuZXI6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCk6IHRoaXM7XHJcblx0XHRvbihldmVudG5hbWU6IHN0cmluZyB8IHN5bWJvbCwgbGlzdGVuZXI6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCk6IHRoaXMge1xyXG5cdFx0XHRyZXR1cm4gc3VwZXIub24oZXZlbnRuYW1lLCBsaXN0ZW5lcik7XHJcblx0XHR9IC8vb25cclxuXHRcdGVtaXQoZXZlbnRuYW1lOiBcImxvZ1wiLCAuLi5hcmdzOiBhbnlbXSk6IGFueTtcclxuXHRcdGVtaXQoZXZlbnRuYW1lOiBcImRlYnVnXCIsIC4uLmFyZ3M6IGFueVtdKTogYW55O1xyXG5cdFx0ZW1pdChldmVudG5hbWU6IFwiY2xlYXJcIiwgbGluZXM6IG51bWJlciwgZGlyOiB0dHkuRGlyZWN0aW9uLCByZWw6IGJvb2xlYW4sIG91dDogYm9vbGVhbik6IGFueTtcclxuXHRcdGVtaXQoZXZlbnRuYW1lOiBcIndyaXRlXCIsIGQ6IHN0cmluZyB8IFVpbnQ4QXJyYXkpOiBzdHJpbmc7XHJcblx0XHRlbWl0KGV2ZW50bmFtZTogXCJtb3ZlXCIsIHg6IG51bWJlciwgeTogbnVtYmVyLCByZWw6IGJvb2xlYW4pOiBib29sZWFuO1xyXG5cdFx0ZW1pdChldmVudG5hbWU6IFwia2V5XCIsIGtleTogc3RyaW5nKTogc3RyaW5nO1xyXG5cdFx0ZW1pdChldmVudG5hbWU6IFwicmF3a2V5XCIsIGtleTogQnVmZmVyKTogQnVmZmVyO1xyXG5cdFx0ZW1pdChldmVudG5hbWU6IHN0cmluZyB8IHN5bWJvbCwgLi4uYXJnczogYW55W10pOiBib29sZWFuO1xyXG5cdFx0ZW1pdChldmVudG5hbWU6IHN0cmluZyB8IHN5bWJvbCwgLi4uYXJnczogYW55W10pOiBhbnkge1xyXG5cdFx0XHRyZXR1cm4gc3VwZXIuZW1pdChldmVudG5hbWUsIC4uLmFyZ3MpO1xyXG5cdFx0fSAvL2VtaXRcclxuXHRcdFxyXG5cdH0gLy9SR0xcclxuXHRcclxufSAvL3JnbFxyXG5cclxuZXhwb3J0IHsgcmdsbSB9O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgcmdsO1xyXG4iXX0=